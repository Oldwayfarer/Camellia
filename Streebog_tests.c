#include <stdlib.h>
#include <stdio.h>
#include "GOST_Streebog.h"

int main(int argc, char** argv){
    uint8_t M1[63] = {0x32, 0x31, 0x30, 0x39, 0x38, 0x37, 0x36, 0x35, 0x34, 0x33, 0x32, 0x31, 0x30, 0x39, 0x38, 0x37,
                      0x36, 0x35, 0x34, 0x33, 0x32, 0x31, 0x30, 0x39, 0x38, 0x37, 0x36, 0x35, 0x34, 0x33, 0x32, 0x31,
                      0x30, 0x39, 0x38, 0x37, 0x36, 0x35, 0x34, 0x33, 0x32, 0x31, 0x30, 0x39, 0x38, 0x37, 0x36, 0x35,
                      0x34, 0x33, 0x32, 0x31, 0x30, 0x39, 0x38, 0x37, 0x36, 0x35, 0x34, 0x33, 0x32, 0x31, 0x30};
    uint8_t M2[72] = {0xfb, 0xe2, 0xe5, 0xf0, 0xee, 0xe3, 0xc8, 0x20, 0xfb, 0xea, 0xfa, 0xeb, 0xef, 0x20, 0xff, 0xfb, 
                      0xf0, 0xe1, 0xe0, 0xf0, 0xf5, 0x20, 0xe0, 0xed, 0x20, 0xe8, 0xec, 0xe0, 0xeb, 0xe5, 0xf0, 0xf2, 
                      0xf1, 0x20, 0xff, 0xf0, 0xee, 0xec, 0x20, 0xf1, 0x20, 0xfa, 0xf2, 0xfe, 0xe5, 0xe2, 0x20, 0x2c, 
                      0xe8, 0xf6, 0xf3, 0xed, 0xe2, 0x20, 0xe8, 0xe6, 0xee, 0xe1, 0xe8, 0xf0, 0xf2, 0xd1, 0x20, 0x2c, 
                      0xe8, 0xf0, 0xf2, 0xe5, 0xe2, 0x20, 0xe5, 0xd1};
    
    uint8_t* hash = Streebog(M1, 63, M512);
    printf("Bunch of tests from GOST 34.11-2018\n");
    printf("Correct results can be found in it.\n");
    dbg_print("message M1, 512-bit hash", hash, 64);   
    hash = Streebog(M1, 63, M256);
    dbg_print("message M1, 256-bit hash", hash, 32);   
    free(hash);
    hash = Streebog(M2, 72, M512);
    dbg_print("message M2, 512-bit hash", hash, 64);   
    free(hash);
    hash = Streebog(M2, 72, M256);
    dbg_print("message M2, 256-bit hash", hash, 32);   
    free(hash);
	return 0;
}

